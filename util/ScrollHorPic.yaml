Variables:
    dpics: /volumes/macdrive/projects/text2video/dpics
    speed: 100
    image: shanghai.png   
    out: out.mp4
    play: yes
    vmargin: 50 # vertical margin
    direct: left
Tube:
    - cd: {dpics}
    - break: >
        'temp' is not allowed for the begining of out file name: {out} --if out.startswith('temp')
    - cmd: ffmpeg -y -i {image} -vf "scale=-1:1920" temp.jpg    
    - cmd: ffprobe -v error -select_streams v:0 -show_format -show_entries stream -of default=nw=1 temp.jpg --result temp.jpg.log
    - get_keys: -f temp.jpg.log -k width, height
    # gen left main page
    - cmd: ffmpeg -y -i temp.jpg -vf "crop=1080:1920:0:0" temp_main.jpg --if direct == left
    # gen right main page
    - cmd: ffmpeg -y -i temp.jpg -vf "crop=1080:1920:{width}-1080:0" temp_main.jpg --if direct == right
    - set: seconds = int((width - 1080) / speed)
    - break: --if no
    - cmd: ffmpeg -y -loop 1 -i temp_main.jpg -c:v libx264 -t {seconds} -pix_fmt yuv420p temp_test.mp4
    - set: new_height = 1920 - 2 * vmargin
    # gen left -> right video
    - cmd: ffmpeg -y -i temp_test.mp4 -loop 1 -i temp.jpg -t {seconds} -filter_complex
        "[0][1]overlay=x=-{speed}*t,scale=-1:{new_height},pad=1080:1920:-1:-1[out]"
        -map "[out]" {out}
        --if direct == left
    # gen right -> left video
    - cmd: ffmpeg -y -i temp_test.mp4 -loop 1 -i temp.jpg -t {seconds} -filter_complex
        "[0][1]overlay=x={speed}*t-({width}-1080),scale=-1:{new_height},pad=1080:1920:-1:-1[out]"
        -map "[out]" {out}
        --if direct == right
    - f_del: temp*
    - cmd: ffplay {out} --if play